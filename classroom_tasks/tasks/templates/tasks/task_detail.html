{% extends "base.html" %}
{% load static %}

{% block title %}Detalle de tarea{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/styles.css' %}">

<div class="task-detail">
    <h2 class="task-title">{{ task.title }}</h2>

    <div class="task-meta">
        <p><strong>Tipo:</strong> {{ task.get_type_display }}</p>
        <p><strong>Estado:</strong>
            {% if task.is_pending %}ğŸŸ¡ Pendiente{% endif %}
            {% if task.is_delivered %}ğŸ”µ Entregada{% endif %}
            {% if task.is_validated %}âœ… Validada{% endif %}
        </p>
        <p><strong>Fecha lÃ­mite:</strong> {{ task.due_date|date:"d/m/Y H:i" }}</p>
        <p><strong>Fecha de creaciÃ³n:</strong> {{ task.created_at|date:"d/m/Y H:i" }}</p>
    </div>

    <div class="task-description">
        <h3>DescripciÃ³n</h3>
        <p>{{ task.description|default:"Sin descripciÃ³n" }}</p>
    </div>

    <div class="task-people">
        <h3>Participantes</h3>
        <p><strong>Creador:</strong> {{ task.creator.username }}</p>
        <p><strong>Miembros:</strong>
            {% for m in task.members.all %}
                {{ m.username }}{% if not forloop.last %}, {% endif %}
            {% empty %}Sin miembros{% endfor %}
        </p>
        {% if task.teacher_validator %}
            <p><strong>Validada por:</strong> {{ task.teacher_validator.username }}</p>
        {% endif %}
    </div>

    <div class="task-actions">
        {% if user.is_alumno and task.is_pending %}
            <a href="{% url 'tasks:deliver_task' task.id %}" class="btn">ğŸ“¤ Entregar</a>
        {% endif %}
        {% if user.is_profesor and task.requires_teacher_validation and task.is_delivered %}
            <a href="{% url 'tasks:validate_task' task.id %}" class="btn">âœ” Validar</a>
        {% endif %}
        <a href="{% url 'tasks:list_my_tasks' %}" class="btn btn-secondary">â¬… Volver</a>
    </div>
</div>
{% endblock %}
